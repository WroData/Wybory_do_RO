plot.title=element_text(size=25,family=czcionka, color="black"),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
ggplot()+
geom_polygon(aes(fill = sr.wiek_kat, x = long, y = lat, group = group),  data = area.points, alpha = 1,  color =  "gray50", size = 0.5) +
coord_equal() +
theme_bw() +
labs(title="\nŚredni wiek kandydatów w wyborach do Rad Osiedli 2017") +
geom_text(data=Środki_osiedli, aes(x=long, y=lat, label=Nazwy),family=czcionka,  size=4, color= "black")  +
scale_fill_manual(values = kolory5, guide = guide_legend(title = "Średni na osielu\nwiek kandydatów")) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
xlab="wiek", ylab="Ilość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks.y=element_blank(),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
xlab="wiek", ylab="Ilość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
#panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
#axis.title=element_blank(),
axis.text=element_blank(),
axis.ticks.y=element_blank(),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
xlab="Wiek", ylab="Ilość kandydatów")
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek", ylabs="Ilość kandydatów")
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek", y="Ilość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
#panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
#axis.title=element_blank(),
#axis.text=element_blank(),
#axis.ticks.y=element_blank(),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek", y="Ilość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
#panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
#axis.ticks.y=element_blank(),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek", y="Ilość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek", y="Ilość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey20"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek", y="Ilość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey90"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek", y="Ilość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey99"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek", y="Ilość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\n                 Rozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="\nWiek", y="Ilość kandydatów\n") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), binwidth = 1) +
geom_density(colour = "red") +
labs(title="\nRozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek\n", y="\nIlość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "#d95f0e", fill = "#fed98e",  binwidth = 1) +
geom_density(colour = "#bd0026") +
labs(title="\nRozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek\n", y="\nIlość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "#fed98e", fill = "#d95f0e",  binwidth = 1) +
geom_density(colour = "#bd0026") +
labs(title="\nRozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek\n", y="\nIlość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 1) +
geom_density(colour = "#bd0026") +
labs(title="\nRozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek\n", y="\nIlość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot()+
geom_polygon(aes(fill = zapelnienie_kat, x = long, y = lat, group = group),  data = area.points, alpha = 1,  color =  "gray50", size = 0.5) +
coord_equal() +
theme_bw() +
labs(title="\nIlość kandydatów na liczbę mandatów w wyborach do Rad Osiedli 2017") +
geom_text(data=Środki_osiedli, aes(x=long, y=lat, label=Nazwy),family=czcionka,  size=4, color= "black")  +
scale_fill_manual(values = kolory6, guide = guide_legend(title = "Ilość kandydatów\nna miejsce")) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
plot.title=element_text(size=25,family=czcionka,color="black", hjust = 0.5),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
##############################################################################
## wykres średniej wieku
ggplot()+
geom_polygon(aes(fill = sr.wiek_kat, x = long, y = lat, group = group),  data = area.points, alpha = 1,  color =  "gray50", size = 0.5) +
coord_equal() +
theme_bw() +
labs(title="\nŚredni wiek kandydatów w wyborach do Rad Osiedli 2017") +
geom_text(data=Środki_osiedli, aes(x=long, y=lat, label=Nazwy),family=czcionka,  size=4, color= "black")  +
scale_fill_manual(values = kolory5, guide = guide_legend(title = "Średni na osielu\nwiek kandydatów")) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
##############################################################################
## rozkłąd wieku kandydatów
pelne_listy<- read.csv2("pełne listy.csv",  header = TRUE, stringsAsFactors=FALSE)
ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 1) +
geom_density(colour = "#bd0026") +
labs(title="\nRozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek\n", y="\nIlość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
plot_list = list()
p = ggplot()+
geom_polygon(aes(fill = zapelnienie_kat, x = long, y = lat, group = group),  data = area.points, alpha = 1,  color =  "gray50", size = 0.5) +
coord_equal() +
theme_bw() +
labs(title="\nIlość kandydatów na liczbę mandatów w wyborach do Rad Osiedli 2017") +
geom_text(data=Środki_osiedli, aes(x=long, y=lat, label=Nazwy),family=czcionka,  size=4, color= "black")  +
scale_fill_manual(values = kolory6, guide = guide_legend(title = "Ilość kandydatów\nna miejsce")) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
plot.title=element_text(size=25,family=czcionka,color="black", hjust = 0.5),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
plot_list[[1]] = p
##############################################################################
## wykres średniej wieku
p = ggplot()+
geom_polygon(aes(fill = sr.wiek_kat, x = long, y = lat, group = group),  data = area.points, alpha = 1,  color =  "gray50", size = 0.5) +
coord_equal() +
theme_bw() +
labs(title="\nŚredni wiek kandydatów w wyborach do Rad Osiedli 2017") +
geom_text(data=Środki_osiedli, aes(x=long, y=lat, label=Nazwy),family=czcionka,  size=4, color= "black")  +
scale_fill_manual(values = kolory5, guide = guide_legend(title = "Średni na osielu\nwiek kandydatów")) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
plot_list[[2]] = p
##############################################################################
## rozkłąd wieku kandydatów
pelne_listy<- read.csv2("pełne listy.csv",  header = TRUE, stringsAsFactors=FALSE)
p = ggplot(pelne_listy, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 1) +
geom_density(colour = "#bd0026") +
labs(title="\nRozkład wieku kandydatów w wyborach do Rad Osiedli 2017",
x="Wiek\n", y="\nIlość kandydatów") +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=15),
axis.text=element_text(family=czcionka, size=13),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
plot_list[[3]] = p
##############################################################################
## zapisyqanie jako png
png(filename="Ilosc kandydatoq na miejsce.png", bg=Kolor_tla, width = 14, height = 10, units = 'in', res = 800)
plot(plot_list[[1]] )
dev.off()
png(filename="Śr qiek kandydatoq na osiedlach.png", bg=Kolor_tla, width = 14, height = 10, units = 'in', res = 800)
plot(plot_list[[2]] )
dev.off()
png(filename="Rozklad qieku.png", bg=Kolor_tla, width = 14, height = 10, units = 'in', res = 800)
plot(plot_list[[3]] )
dev.off()
ggplot()+
geom_polygon(aes(fill = zapelnienie_kat, x = long, y = lat, group = group),  data = area.points, alpha = 1,  color =  "gray50", size = 0.5) +
coord_equal() +
theme_bw() +
labs(title="\nIlość kandydatów na liczbę mandatów w wyborach do Rad Osiedli 2017") +
geom_text(data=Środki_osiedli, aes(x=long, y=lat, label=Nazwy),family=czcionka,  size=4, color= "black")  +
scale_fill_manual(values = kolory6, guide = guide_legend(title = "Ilość kandydatów\nna miejsce")) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
plot.title=element_text(size=25,family=czcionka,color="black", hjust = 0.5),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
kolory6<-c("#ffffd4", '#fee391','#fec44f','#fe9929','#d95f0e','#993404') #skala 6 kolorów
ggplot()+
geom_polygon(aes(fill = zapelnienie_kat, x = long, y = lat, group = group),  data = area.points, alpha = 1,  color =  "gray50", size = 0.5) +
coord_equal() +
theme_bw() +
labs(title="\nIlość kandydatów na liczbę mandatów w wyborach do Rad Osiedli 2017") +
geom_text(data=Środki_osiedli, aes(x=long, y=lat, label=Nazwy),family=czcionka,  size=4, color= "black")  +
scale_fill_manual(values = kolory6, guide = guide_legend(title = "Ilość kandydatów\nna miejsce")) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
plot.title=element_text(size=25,family=czcionka,color="black", hjust = 0.5),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
p = ggplot()+
geom_polygon(aes(fill = zapelnienie_kat, x = long, y = lat, group = group),  data = area.points, alpha = 1,  color =  "gray50", size = 0.5) +
coord_equal() +
theme_bw() +
labs(title="\nIlość kandydatów na liczbę mandatów w wyborach do Rad Osiedli 2017") +
geom_text(data=Środki_osiedli, aes(x=long, y=lat, label=Nazwy),family=czcionka,  size=4, color= "black")  +
scale_fill_manual(values = kolory6, guide = guide_legend(title = "Ilość kandydatów\nna miejsce")) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
plot.title=element_text(size=25,family=czcionka,color="black", hjust = 0.5),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
plot_list[[1]] = p
png(filename="Ilosc kandydatoq na miejsce.png", bg=Kolor_tla, width = 14, height = 10, units = 'in', res = 800)
plot(plot_list[[1]] )
dev.off()
area.points$zapelnienie_kat <- ifelse(area.points$zapelnienie == 1,  "1",
ifelse(area.points$zapelnienie < 1.5, "(1; 1,5)",
ifelse(area.points$zapelnienie < 2,   "<1,5; 2)",
ifelse(area.points$zapelnienie < 2.5, "<2; 2,5)", ">=2,5")))))
area.points$zapelnienie_kat <- factor(area.points$zapelnienie_kat, c("1", "(1; 1,5)","<1,5; 2)", "<2; 2,5)", ">=2,5"))
area.points$zapelnienie_kat <- ifelse(area.points$zapelnienie == 1,  "1",
ifelse(area.points$zapelnienie < 1.5, "(1; 1,5)",
ifelse(area.points$zapelnienie < 2,   "<1,5; 2)",
ifelse(area.points$zapelnienie < 2.5, "<2; 2,5)", ">=2,5"))))
p = ggplot()+
geom_polygon(aes(fill = zapelnienie_kat, x = long, y = lat, group = group),  data = area.points, alpha = 1,  color =  "gray50", size = 0.5) +
coord_equal() +
theme_bw() +
labs(title="\nIlość kandydatów na liczbę mandatów w wyborach do Rad Osiedli 2017") +
geom_text(data=Środki_osiedli, aes(x=long, y=lat, label=Nazwy),family=czcionka,  size=4, color= "black")  +
scale_fill_manual(values = kolory5, guide = guide_legend(title = "Ilość kandydatów\nna miejsce")) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_blank(),#element_line(linetype="solid",color="#e0e0e0"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_blank(),
axis.text=element_blank(),
plot.title=element_text(size=25,family=czcionka,color="black", hjust = 0.5),
axis.ticks.y=element_blank(),
plot.margin = unit(c(0,0,0,0), "lines"),
#        legend.background=element_rect(fill=Kolor_tla,linetype="solid",color="black"),
legend.text=element_text(family=czcionka, size=13),
legend.title=element_text(family=czcionka, size=15),
legend.key=element_blank())
plot_list[[1]] = p
## zapisyqanie jako png
png(filename="Ilosc kandydatoq na miejsce.png", bg=Kolor_tla, width = 14, height = 10, units = 'in', res = 800)
plot(plot_list[[1]] )
dev.off()
png(filename="Ilosc kandydatoq na miejsce.png", bg=Kolor_tla, width = 14, height = 10, units = 'in', res = 300)
plot(plot_list[[1]] )
dev.off()
png(filename="Śr qiek kandydatoq na osiedlach.png", bg=Kolor_tla, width = 14, height = 10, units = 'in', res = 300)
plot(plot_list[[2]] )
dev.off()
png(filename="Rozklad qieku.png", bg=Kolor_tla, width = 14, height = 10, units = 'in', res = 300)
plot(plot_list[[3]] )
dev.off()
